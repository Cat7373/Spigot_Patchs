From 88590e822354c33544c146884ce6f62868a06edb Mon Sep 17 00:00:00 2001
From: Cat73 <1901803382@qq.com>
Date: Tue, 6 Dec 2016 15:08:41 +0800
Subject: [PATCH] Cat73 -> Remove Debug checks from DataBits
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

getType 是一个热点方法，去掉里面的边界检查能将降低 90% 以上的执行时间。
这个边界检查会在超出边界时直接抛异常导致服务器崩溃，因此应该可以安全的移除。
Link: https://github.com/PaperMC/Paper/blob/ebf1094ea5dea6f3c8ad0ed5a1344089cb7ecfc7/Spigot-Server-Patches/0114-Remove-Debug-checks-from-DataBits.patch

diff --git a/src/main/java/net/minecraft/server/DataBits.java b/src/main/java/net/minecraft/server/DataBits.java
index f3a6799a..5d01490a 100644
--- a/src/main/java/net/minecraft/server/DataBits.java
+++ b/src/main/java/net/minecraft/server/DataBits.java
@@ -10,7 +10,7 @@ public class DataBits {
     private final int d;
 
     public DataBits(int i, int j) {
-        Validate.inclusiveBetween(1L, 32L, (long) i);
+        // Validate.inclusiveBetween(1L, 32L, (long) i);
         this.d = j;
         this.b = i;
         this.c = (1L << i) - 1L;
@@ -18,8 +18,8 @@ public class DataBits {
     }
 
     public void a(int i, int j) {
-        Validate.inclusiveBetween(0L, (long) (this.d - 1), (long) i);
-        Validate.inclusiveBetween(0L, this.c, (long) j);
+        // Validate.inclusiveBetween(0L, (long) (this.d - 1), (long) i);
+        // Validate.inclusiveBetween(0L, this.c, (long) j);
         int k = i * this.b;
         int l = k / 64;
         int i1 = ((i + 1) * this.b - 1) / 64;
@@ -36,7 +36,7 @@ public class DataBits {
     }
 
     public int a(int i) {
-        Validate.inclusiveBetween(0L, (long) (this.d - 1), (long) i);
+        // Validate.inclusiveBetween(0L, (long) (this.d - 1), (long) i);
         int j = i * this.b;
         int k = j / 64;
         int l = ((i + 1) * this.b - 1) / 64;
-- 
2.12.0.windows.1

