From 46b76a1e4d89c793e101158f6d2ecb07cf1bed26 Mon Sep 17 00:00:00 2001
From: Cat73 <1901803382@qq.com>
Date: Thu, 23 Jun 2016 13:25:55 +0800
Subject: [PATCH] Cat73 -> Use-Optimized-Collections
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

使用 FastUtil 代替 HashSet 与 HashMap
Link: https://github.com/PaperMC/Paper/blob/0973e46de1d6dfba2bc6df1c49f973205e408911/Spigot-Server-Patches/0114-Use-Optimized-Collections.patch#L6

diff --git a/src/main/java/net/minecraft/server/ChunkProviderServer.java b/src/main/java/net/minecraft/server/ChunkProviderServer.java
index 9a57c5c..58a4dfd 100644
--- a/src/main/java/net/minecraft/server/ChunkProviderServer.java
+++ b/src/main/java/net/minecraft/server/ChunkProviderServer.java
@@ -22,7 +22,7 @@ import org.bukkit.event.world.ChunkUnloadEvent;
 public class ChunkProviderServer implements IChunkProvider {
 
     private static final Logger a = LogManager.getLogger();
-    public final Set<Long> unloadQueue = Sets.newHashSet();
+    public final Set<Long> unloadQueue = new it.unimi.dsi.fastutil.longs.LongArraySet(); // Paper
     public final ChunkGenerator chunkGenerator;
     private final IChunkLoader chunkLoader;
     // Paper start
diff --git a/src/main/java/net/minecraft/server/DataWatcher.java b/src/main/java/net/minecraft/server/DataWatcher.java
index 47968a8..415e19f 100644
--- a/src/main/java/net/minecraft/server/DataWatcher.java
+++ b/src/main/java/net/minecraft/server/DataWatcher.java
@@ -21,7 +21,7 @@ public class DataWatcher {
     private static final Logger a = LogManager.getLogger();
     private static final Map<Class<? extends Entity>, Integer> b = Maps.newHashMap();
     private final Entity c;
-    private final Map<Integer, DataWatcher.Item<?>> d = Maps.newHashMap();
+    private final Map<Integer, DataWatcher.Item<?>> d = new it.unimi.dsi.fastutil.ints.Int2ObjectOpenHashMap<DataWatcher.Item<?>>(); // Paper
     private final ReadWriteLock e = new ReentrantReadWriteLock();
     private boolean f = true;
     private boolean g;
-- 
2.9.0.windows.1

