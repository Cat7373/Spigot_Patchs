From b2f69301e3d2fc67cbc172976f67825eefe52d37 Mon Sep 17 00:00:00 2001
From: Cat73 <root@cat73.org>
Date: Wed, 7 Aug 2019 09:59:36 +0800
Subject: [PATCH] Cat73 -> Optimize GameRules to use LinkedHashMap
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

TreeMap.get(k) 的性能较差，用 HashMap 替换它

Link: https://github.com/PaperMC/Paper/blob/b6c32b2a159aa9adf982d4cdf5aada6c5d65396b/Spigot-Server-Patches/0374-Optimize-GameRules-to-use-LinkedHashMap.patch

diff --git a/src/main/java/net/minecraft/server/GameRules.java b/src/main/java/net/minecraft/server/GameRules.java
index 45d5675ad..58b3d0ec9 100644
--- a/src/main/java/net/minecraft/server/GameRules.java
+++ b/src/main/java/net/minecraft/server/GameRules.java
@@ -21,9 +21,7 @@ import org.apache.logging.log4j.Logger;
 public class GameRules {
 
     private static final Logger LOGGER = LogManager.getLogger();
-    private static final Map<GameRules.GameRuleKey<?>, GameRules.GameRuleDefinition<?>> z = Maps.newTreeMap(Comparator.comparing((gamerules_gamerulekey) -> {
-        return gamerules_gamerulekey.a;
-    }));
+    private static final Map<GameRules.GameRuleKey<?>, GameRules.GameRuleDefinition<?>> z = Maps.newLinkedHashMap(); // Paper
     public static final GameRules.GameRuleKey<GameRules.GameRuleBoolean> DO_FIRE_TICK = a("doFireTick", GameRules.GameRuleBoolean.b(true));
     public static final GameRules.GameRuleKey<GameRules.GameRuleBoolean> MOB_GRIEFING = a("mobGriefing", GameRules.GameRuleBoolean.b(true));
     public static final GameRules.GameRuleKey<GameRules.GameRuleBoolean> KEEP_INVENTORY = a("keepInventory", GameRules.GameRuleBoolean.b(false));
-- 
2.22.0

