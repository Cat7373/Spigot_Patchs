From 928a4f2abe076560a6393d413d40f7385f3db062 Mon Sep 17 00:00:00 2001
From: Cat73 <1901803382@qq.com>
Date: Tue, 12 Apr 2016 13:47:56 +0800
Subject: [PATCH] Cat73 -> Optimize BlockStateList/BlockData
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

热点方法，会通过预先判断来实现在出现异常的时候崩溃报告里能多点信息，这份优化把这些去掉了。
Link：https://github.com/PaperMC/Paper/blob/cd3d8fb27e4a6717146bf7256f37034285a303d7/Spigot-Server-Patches/0062-Optimize-getBlockData.patch

diff --git a/src/main/java/net/minecraft/server/BlockStateList.java b/src/main/java/net/minecraft/server/BlockStateList.java
index 5af47d0..cd51796 100644
--- a/src/main/java/net/minecraft/server/BlockStateList.java
+++ b/src/main/java/net/minecraft/server/BlockStateList.java
@@ -144,21 +144,11 @@ public class BlockStateList {
         }
 
         public <T extends Comparable<T>> T get(IBlockState<T> iblockstate) {
-            if (!this.b.containsKey(iblockstate)) {
-                throw new IllegalArgumentException("Cannot get property " + iblockstate + " as it does not exist in " + this.a.t());
-            } else {
-                return iblockstate.b().cast(this.b.get(iblockstate));
-            }
+            return iblockstate.b().cast(this.b.get(iblockstate)); // Paper
         }
 
         public <T extends Comparable<T>, V extends T> IBlockData set(IBlockState<T> iblockstate, V v0) {
-            if (!this.b.containsKey(iblockstate)) {
-                throw new IllegalArgumentException("Cannot set property " + iblockstate + " as it does not exist in " + this.a.t());
-            } else if (!iblockstate.c().contains(v0)) {
-                throw new IllegalArgumentException("Cannot set property " + iblockstate + " to " + v0 + " on block " + Block.REGISTRY.b(this.a) + ", it is not an allowed value");
-            } else {
-                return (IBlockData) (this.b.get(iblockstate) == v0 ? this : (IBlockData) this.c.get(iblockstate, v0));
-            }
+            return this.b.get(iblockstate) == v0 ? this : this.c.get(iblockstate, v0); // Paper
         }
 
         public ImmutableMap<IBlockState<?>, Comparable<?>> s() {
-- 
2.8.0.windows.1

